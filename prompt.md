1. 创建/root/data1/zjj/Grokking_Formulation/src/qk_circut.py，取100，500，1000，5000，10000，50000，990000七个步数的权重矩阵，计算有效的注意力交互矩阵 $A = W_E W_Q W_K^T W_E^T$（维度 $p \times p$），对这个 $p \times p$ 矩阵进行 二维离散傅里叶变换 (2D DFT)，将数据保存为/root/data1/zjj/Grokking_Formulation/data/x+y/qk_circut.csv，然后创建/root/data1/zjj/Grokking_Formulation/src/plot/qk_circut.py，使用qk_circut.csv文件，绘制2D频谱图，最后保存/root/data1/zjj/Grokking_Formulation/experiments/figures下，执行上述任务。

2.  修改/root/data1/zjj/Grokking_Formulation/src/gini_ipr.py，使用/root/data1/zjj/Grokking_Formulation/data/x+y/checkpoints中保存的权重文件，提取输入嵌入矩阵W_e，将其铺平为一维向量，DFT转换成频域，再计算其Gini系数和IPR逆参与率，将数据保存为/root/data1/zjj/Grokking_Formulation/data/x+y/gini_ip.csv，然后修改/root/data1/zjj/Grokking_Formulation/src/plot/gini_ip.py，使用gini_ip.csv文件和metric.csv绘图体现随着训练步数，训练/测试的Acc以及Gini/IPR变化，横轴为训练步数，纵轴为相似度，三y轴，横轴依然采用对数刻度，最后保存/root/data1/zjj/Grokking_Formulation/experiments/figures下，执行上述任务。

修改/root/data1/zjj/Grokking_Formulation/src/qk_circut.py，取100，500，1000，5000，10000，50000，990000七个步数的权重矩阵，计算有效的注意力交互矩阵 $A = W_E W_Q W_K^T W_E^T$（维度 $p \times p$），对这个 $p \times p$ 矩阵进行 二维离散傅里叶变换 (2D DFT)，将数据保存为/root/data1/zjj/Grokking_Formulation/data/x+y/qk_circut.csv，然后修改/root/data1/zjj/Grokking_Formulation/src/plot/qk_circut.py，使用qk_circut.csv文件，绘制2D频谱图不变，只是改为7个点的变化，最后保存/root/data1/zjj/Grokking_Formulation/experiments/figures下，执行上述任务。

3. 创建/root/data1/zjj/Grokking_Formulation/src/intrinsic_dimension.py，使用/root/data1/zjj/Grokking_Formulation/data/x+y/checkpoints中保存的全部权重文件，提取输入嵌入矩阵W_e和输出嵌入W_u，使用TwoNN方法计算其内在维度（ID），以及计算有效矩阵W_QK=W_Q（W_K）T,对齐进行SVD分解计算有效秩和谱熵，将数据保存为/root/data1/zjj/Grokking_Formulation/data/x+y/intrinsic_dimension.csv，然后创建/root/data1/zjj/Grokking_Formulation/src/plot/intrinsic_dimension.py，使用intrinsic_dimension.csv文件和metric.csv绘图体现随着训练步数，训练/测试的Acc以及内在维度变化，横轴为训练步数，纵轴为acc和维度数，双y轴，横轴依然采用对数刻度，最后保存/root/data1/zjj/Grokking_Formulation/experiments/figures下，执行上述任务。

基于之前的实验现象：Gini系数基本保持不变，IPR在grokking时刻陡降，psd热力图不随步数变化，余弦相似度先上升后不变再在grokking时刻上升，并且2D频域图确实在grokking时刻出现明显对角线，W_u的内在维度（ID）先升（训练acc迅速上升）后降（测试acc迅速上升），W_e的ID是随着过拟合上升，后在grokking前下降，W_e的谱熵一直上升，W_u谱熵出现双重下降现象（分别对应训练和测试acc的迅速上升），分析背后的机制，并进一步探究。